# wechat-miniprogram-shop-feed-chat

# WeChat Mini Program - Shop, Feed & Chat

&gt; 一个集商城交易、动态广场、即时通讯于一体的微信小程序全栈 Demo  
&gt; *—— 记录一次未完成的创业尝试*

---

## 📖 项目背景

这是本人在大学初期（2024年）为创业项目开发的完整微信小程序。项目初衷是打造一个**二次元周边自由交易平台**，结合社区互动与即时通讯，让同好之间能安全便捷地交易"谷子"、手办等商品。

因学业规划与现实因素，项目最终未能上线，现将代码开源，作为学习微信云开发的参考案例。

**项目特点：**
- ✅ 完整的用户账号体系（与微信 OpenID 绑定）
- ✅ 三大核心模块：商城交易 + 动态广场 + 群聊/私聊
- ✅ 全栈基于微信云开发（云数据库 + 云函数），无需搭建后端服务器
- ✅ 功能扩展性强

---

## 🛠 技术栈

- **前端框架**：微信小程序原生开发（WXML + WXSS + JavaScript）
- **后端服务**：微信云开发（CloudBase）
  - 云数据库（NoSQL）
  - 云函数（Node.js）
  - 云存储（图片资源）
- **开发工具**：微信开发者工具
- **实时通讯**：WebSocket（watch 实时监听）

---

## 🚀 核心功能

### 0️⃣ 账号系统
- 微信一键登录，自动绑定 OpenID
- 个人资料管理（头像、昵称、简介）
- 用户主页展示（在售商品、历史动态）

### 1️⃣ 商城交易（二手市场）
类似"闲鱼"的 C2C 交易模式：

- **商品发布**：上传图片、填写标题/价格/分类/介绍
- **智能筛选**：支持分类筛选（谷子、手办、漫画等）+ 关键词搜索
- **互动功能**：商品收藏、评论区留言
- **交易入口**：通过卖家主页一键进入私聊/议价窗口

### 2️⃣ 动态广场（社区功能）
类似"小红书"的图文社区：

- **内容发布**：图文混排，支持自定义标签（Tag）
- **内容发现**：按 Tag 筛选或关键词搜索
- **社交互动**：点赞、评论
- **个人主页**：展示用户历史发布内容

### 3️⃣ 即时通讯（私聊 & 群聊）
完整的 IM 功能：

- **好友系统**：通过 OpenID 搜索添加好友
- **私聊功能**：文字、图片消息，实时推送（基于云数据库 watch）
- **群聊功能**：加入/创建不同主题的群组（IP 相关群聊）
- **交易聊天**：商品详情页直接跳转至交易专用聊天窗口

---

## 📂 项目结构
miniprogram/
├── pages/
│   ├── shopping/        # 商城首页
│   ├── square/          # 动态广场
│   ├── messages/        # 消息列表（群聊/私聊/好友申请）
│   ├── mine/            # 个人中心
│   ├── gooddetail/      # 商品详情页
│   ├── postdetail/      # 帖子详情页
│   ├── chatting/        # 聊天界面
│   └── ...
├── cloudfunctions/      # 云函数
│   ├── GetGoods/        # 获取商品列表
│   ├── UploadGood/      # 发布商品
│   ├── GetFriends/      # 获取好友列表
│   └── ...
├── app.js               # 全局逻辑（含实时监听未读消息）
└── app.json             # 全局配置


---

## ⚠️ 已知问题 & 注意事项

1. **性能优化**：由于完全依赖微信云开发，在高并发场景下（大量图片加载、频繁数据库查询）可能出现轻微卡顿，建议后续接入 Redis 或优化查询策略
2. **权限设置**：部分云数据库集合需要设置为"所有用户可读"才能支持实时监听（已在前端处理权限判断）
3. **敏感信息**：上传代码前已移除真实的云开发环境 ID，使用前需自己配置

---

## 📝 使用说明

### 环境准备
0.下载微信开发者工具
1. 注册微信小程序账号（个人版即可）
2. 开通微信云开发环境
3. 创建以下数据库集合：
   
| 集合名 | 说明 |

|--------|------|

| `User` | 用户资料、好友关系、群组关系 |

| `goods` | 商品信息（**小写 g**） |

| `Moments` | 动态/帖子内容 |

| `PrivateChat` | 好友私聊消息记录 |

| `NegotiationChat` | 交易议价聊天（买卖双方临时会话） |

| `GroupChat` | 群组信息及群聊消息 |

| `IPs` | IP（知识产权）分类管理，如游戏、动漫分区 |

### 部署步骤
```bash
# 克隆项目
git clone https://github.com/Airlxis/wechat-miniprogram-shop-feed-chat.git

# 在微信开发者工具中导入项目
# 1. 填写自己的 AppID
# 2. 在 app.js 中配置云开发环境 ID
# 3. 一一右键 cloudfunctions 文件夹，选择"创建并部署：云端安装依赖"




